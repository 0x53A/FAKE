version: 2

jobs:
  build:
    working_directory: /build
    docker:
      - image: matthid/fsharp-docker
    steps:
      - checkout
      - run:
          name: install-fake
          command: |
            apt-get update
            apt-get install libunwind8 libicu52 unzip
            wget https://github.com/fsharp/FAKE/releases/download/5.0.0-beta024/fake-dotnetcore-ubuntu.14.04-x64.zip -O /tmp/fake-dotnetcore-ubuntu.14.04-x64.zip
            mkdir fake-dotnetcore
            unzip /tmp/fake-dotnetcore-ubuntu.14.04-x64.zip -d fake-dotnetcore || echo unzip returned $?
            export PATH=$PATH:$PWD/fake-dotnetcore/
            chmod +x $PWD/fake-dotnetcore/fake
      - run:
          name: build-project
          command: '$PWD/fake-dotnetcore/fake run build.fsx'