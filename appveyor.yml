image: Visual Studio 2017
install:
  - cinst fake -pre
build_script:
# See https://stackoverflow.com/a/12866669/1269722
  - ps: |
      & fake.exe -v run build.fsx 2>&1
      if ($LASTEXITCODE -ne 0) {
        throw "fake failed with $LASTEXITCODE" 
      } else {
        Write-Host "Fake build finished sucessfully"
      }
#  - ps: .\build.cmd
on_failure:
  - appveyor PushArtifact FAKE.svclog
test: off
environment:
  PAKET_BOOTSTRAPPER_TRACE: true

artifacts:
  - path: 'nuget\dotnetcore\*.nupkg'
    type: NuGetPackage
  - path: 'nuget\legacy\*.nupkg'
    type: NuGetPackage
  - path: 'nuget\dotnetcore\Fake.netcore\*.zip'
    type: Zip
